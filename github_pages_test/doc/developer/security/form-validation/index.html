<!DOCTYPE html>
<html lang="en">
<head>
<title>
Securely implementing form validation
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/sites/default/files/jenkins_favicon.ico" rel="shortcut icon" type="image/x-icon">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/img/favicon.ico" rel="icon" sizes="32x32" type="img/png">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/img/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/img/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/img/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/img/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/img/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152">
<meta content="Securely implementing form validation" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Securely implementing form validation" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Securely implementing form validation" property="og:title">
<meta content="article" property="og:type">
<meta content="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/security/form-validation/index.html" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Securely implementing form validation" property="og:site_name">
<meta content="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/images/logo-title-opengraph.png" name="og:image">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/assets/bower/tether/css/tether.min.css" media="screen" rel="stylesheet">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/css/font-icons.css" media="screen" rel="stylesheet">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/css/jenkins.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/assets/bower/ionicons/css/ionicons.min.css" media="screen" rel="stylesheet">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/css/footer.css" media="screen" rel="stylesheet">
<link href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/css/font-awesome.min.css" media="screen" rel="stylesheet">
</head>
<body>
<script src="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<nav class="navbar navbar-expand-md navbar-dark top bg-dark fixed-top" id="ji-toolbar">
<a class="navbar-brand" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test">
Jenkins
</a>
<button class="navbar-toggler" data-target="#CollapsingNavbar" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="CollapsingNavbar">
<ul class="nav navbar-nav ml-auto">
<li class="nav-item">
<a class="nav-link" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/node">
Blog
</a>
</li>
<li class="nav-item dropdown">
<!-- starting partial dropdown.html.haml -->
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown">
Documentation
</button>

<!-- ending partial dropdown.html.haml -->
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc">
Use Jenkins
</a>
<a class="dropdown-item" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer">
Extend Jenkins
</a>
<span class="dropdown-item">
<strong>
Use-cases
</strong>
</span>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/android">
&nbsp;-&nbsp;Android
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/c">
&nbsp;-&nbsp;C/C++
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/docker">
&nbsp;-&nbsp;Docker
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/embedded">
&nbsp;-&nbsp;Embedded
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/github">
&nbsp;-&nbsp;GitHub
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/java">
&nbsp;-&nbsp;Java
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/php">
&nbsp;-&nbsp;PHP
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/pipeline">
&nbsp;-&nbsp;Continuous Delivery
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/python">
&nbsp;-&nbsp;Python
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/ruby">
&nbsp;-&nbsp;Ruby
</a>
</div>
</li>
<li class="nav-item">
<a class="nav-link" href="https://plugins.jenkins.io/">
Plugins
</a>
</li>
<li class="nav-item dropdown">
<!-- starting partial dropdown.html.haml -->
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown">
Community
</button>

<!-- ending partial dropdown.html.haml -->
<div class="dropdown-menu">
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/participate">
Overview
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/chat" title="Chat with the rest of the Jenkins community on IRC">
Chat
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/projects/jam">
Meet
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/events">
Events
</a>
<a class="dropdown-item feature" href="https://issues.jenkins-ci.org/">
Issue Tracker
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/mailing-lists" title="Browse Jenkins mailing list archives and/or subscribe to lists">
Mailing Lists
</a>
<a class="dropdown-item feature" href="https://wiki.jenkins.io/">
Wiki
</a>
<a class="dropdown-item feature" href="https://accounts.jenkins.io/" title="Create/manage your account for accessing wiki, issue tracker, etc">
Account Management
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/sigs/">
<strong>
Special Interest Groups
</strong>
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/sigs/advocacy-and-outreach/">
&nbsp;-&nbsp;Advocacy and Outreach
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/sigs/chinese-localization/">
&nbsp;-&nbsp;Chinese Localization
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/sigs/cloud-native/">
&nbsp;-&nbsp;Cloud Native
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/sigs/docs/">
&nbsp;-&nbsp;Documentation
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/sigs/gsoc/">
&nbsp;-&nbsp;Google Summer of Code
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/sigs/hw-and-eda/">
&nbsp;-&nbsp;Hardware and EDA
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/sigs/pipeline-authoring/">
&nbsp;-&nbsp;Pipeline Authoring
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/sigs/platform/">
&nbsp;-&nbsp;Platform
</a>
</div>
</li>
<li class="dropdown nav-item">
<!-- starting partial dropdown.html.haml -->
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown">
Subprojects
</button>

<!-- ending partial dropdown.html.haml -->
<div class="dropdown-menu">
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/projects/">
Overview
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/projects/blueocean/">
Blue Ocean
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/projects/evergreen/">
Evergreen
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/projects/gsoc/">
Google Summer of Code in Jenkins
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/projects/infrastructure/">
Infrastructure
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/projects/jam/">
Jenkins Area Meetups
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/projects/jcasc/">
Jenkins Configuration as Code
</a>
<a class="dropdown-item feature" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/projects/remoting/">
Jenkins Remoting
</a>
</div>
</li>
<li class="nav-item dropdown">
<!-- starting partial dropdown.html.haml -->
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown">
About
</button>

<!-- ending partial dropdown.html.haml -->
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/security">
Security
</a>
<a class="dropdown-item" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/press">
Press
</a>
<a class="dropdown-item" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/awards">
Awards
</a>
<a class="dropdown-item" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/project/conduct">
Conduct
</a>
<a class="dropdown-item" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/artwork">
Artwork
</a>
</div>
</li>
<li class="nav-item dropdown">
<!-- starting partial dropdown.html.haml -->
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown">
English
</button>

<!-- ending partial dropdown.html.haml -->
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/zh">
中文 Chinese
</a>
</div>
</li>
<li class="nav-item">
<a class="nav-link btn btn-outline-secondary" href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/download">
Download
</a>
</li>
</ul>
</div>
</nav>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<style>
  ol li i.icon-warning::before {
    content: "\f071";
    color: #bf6900;
    font-family: FontAwesome !important;
    font-size: 10px;
    vertical-align: middle;
  }
</style>
<script>
  $(function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row.body h' + i);
    }
  })
</script>
<div class="container">
<div class="row body">
<div class="col-lg-3">
<div class="sidebar-nav tour">
<h4>
Topics
</h4>
<ol>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/architecture" class="">Architecture</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/initialization" class="">Initialization and Startup</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/extensibility" class="">Extensibility</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/model" class="">Model</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/handling-requests" class="">Handling Requests</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/security" class="active">Security</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/persistence" class="">Persistence</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/scheduling" class="">Scheduling</a>
<i class="icon-warning" title="Early work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/views" class="">Views</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/forms" class="">Forms</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/internationalization" class="">Internationalization and Localization</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/distributed-builds" class="">Distributed Builds</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/cli" class="">Jenkins CLI</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/testing" class="">Testing</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/plugin-development" class="">Plugin development</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/publishing" class="">Publishing Plugins</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/blueocean-plugin-development" class="">Blue Ocean</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/building" class="">Building and Debugging</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/development-environment" class="">Setting up a Development Environment</a>
<i class="icon-warning" style="opacity: 0.5;" title="Partial work in progress">
&nbsp;
</i>
</li>
</ol>
<h4>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/guides" class="">How-To Guides</a>
</h4>
<h4>
Resources
</h4>
<h5>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/extensions" class="">Extensions Index</a>
</h5>
<h5>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/javadoc" class="">Javadoc</a>
</h5>
<h5>
Taglibs
</h5>
<ul>
<li>
<a href="https://reports.jenkins.io/core-taglib/jelly-taglib-ref.html" target="_blank">
Core
</a>
</li>
<li>
<a href="https://stapler.kohsuke.org/jelly-taglib-ref.html" target="_blank">
Stapler
</a>
</li>
<li>
<a href="https://commons.apache.org/proper/commons-jelly/tags.html" target="_blank">
Jelly Core
</a>
</li>
</ul>
<h5>
Tools
</h5>
<ul>
<li>
<a href="https://jenkinsci.github.io/maven-hpi-plugin/" target="_blank">
Maven HPI Plugin
</a>
</li>
</ul>
</div>
</div>
<div class="col-lg-9">
<h1>
Securely implementing form validation
</h1>
<p>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc/developer/guides">
View the index of available developer guides
</a>
</p>
<div class="paragraph">
<p>This guide looks at form validation from a security point of view:
What are the considerations for securing form validation, and how can they be best implemented?</p>
</div>
<div class="paragraph">
<p>First, let&#8217;s look at a typical form field defined in Jelly, and its validation method in the object&#8217;s descriptor.
This forms the basis for the rest of this guide.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;f:entry</span> <span style="color:#b48">field</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;f:textbox</span> <span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/f:entry&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> FormValidation doCheckFoo(<span style="color:#007">@QueryParameter</span> <span style="color:#0a8;font-weight:bold">String</span> value) {
  <span style="color:#080;font-weight:bold">if</span> (<span style="color:#0a8;font-weight:bold">Util</span>.fixEmptyAndTrim(value) == <span style="color:#069">null</span>) {
    <span style="color:#080;font-weight:bold">return</span> FormValidation.error(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo cannot be empty</span><span style="color:#710">&quot;</span></span>);
  }
  <span style="color:#080;font-weight:bold">return</span> FormValidation.ok();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Stapler routing and Jenkins behavior will result in this method being routed at a URL like <code>/descriptorByName/f.q.ClassName/checkFoo</code>.
This URL will contain a minimal HTML snippet with a form validation message (if present) based on the presence and value of the <code>value</code> query parameter.</p>
</div>
<div class="sect2">
<h3 id="potential-security-issues"><a class="anchor" href="#potential-security-issues"></a>Potential Security Issues</h3>
<div class="sect3">
<h4 id="returning-private-information"><a class="anchor" href="#returning-private-information"></a>Returning Private Information</h4>
<div class="paragraph">
<p>By default, any user with Overall/Read access can access form validation methods like the example method above.
Some form validation methods could be used to infer private information, and as such may need to be protected from unauthorized access.</p>
</div>
<div class="paragraph">
<p>If a form validation method is supposed to only be accessible to users with specific permissions, a permission check should be added.</p>
</div>
</div>
<div class="sect3">
<h4 id="side-effects"><a class="anchor" href="#side-effects"></a>Side Effects</h4>
<div class="paragraph">
<p>Form validation can become quite complex and have side effects.
For example, Jenkins might evaluate a Groovy script passed as parameter, or access a URL passed as parameter.
These behaviors could be exploited to result in arbitrary code execution and server-side request forgery, respectively.</p>
</div>
<div class="paragraph">
<p>Ensuring that form validation code such as this is protected with appropriate permission checks, it might not be enough:
<a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">Cross-site request forgery</a> is an attack on users with the necessary privileges and exploits the trust Jenkins has in these legitimate users' web browsers.
Protecting from these attacks requires that form validation methods with side effects only accept <code>POST</code> requests.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="implementing-form-validation"><a class="anchor" href="#implementing-form-validation"></a>Implementing Form Validation</h3>
<div class="sect3">
<h4 id="checking-permissions"><a class="anchor" href="#checking-permissions"></a>Checking permissions</h4>
<div class="paragraph">
<p>To check for global permissions like <code>Administer</code>, add a call to <code>Jenkins#checkPermission</code>. Note that Overall/Read permission is always implied (unless you specifically implement <a href="http://javadoc.jenkins.io/byShortName/UnprotectedRootAction" title="Javadoc for UnprotectedRootAction">UnprotectedRootAction</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> FormValidation doCheckFoo(<span style="color:#007">@QueryParameter</span> <span style="color:#0a8;font-weight:bold">String</span> value) {
  Jenkins.get().checkPermission(Jenkins.ADMINISTER); <span style="color:#777">// or Jenkins.getInstance() on older core baselines</span>
  <span style="color:#080;font-weight:bold">if</span> (<span style="color:#0a8;font-weight:bold">Util</span>.fixEmptyAndTrim(value) == <span style="color:#069">null</span>) {
    <span style="color:#080;font-weight:bold">return</span> FormValidation.error(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo cannot be empty</span><span style="color:#710">&quot;</span></span>);
  }
  <span style="color:#080;font-weight:bold">return</span> FormValidation.ok();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a different <a href="http://javadoc.jenkins.io/byShortName/AccessControlled" title="Javadoc for AccessControlled">AccessControlled</a>'s permissions are to be checked, as the form validation depends on the context in which the method is invoked (e.g. when writing a build step and validation depends on the identity of the item), you may need to add an <a href="http://javadoc.jenkins.io/byShortName/AncestorInPath" title="Javadoc for AncestorInPath"><code>@AncestorInPath</code></a> annotated parameter to get to the necessary context.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> FormValidation doCheckFoo(<span style="color:#007">@QueryParameter</span> <span style="color:#0a8;font-weight:bold">String</span> value, <span style="color:#007">@AncestorInPath</span> Item item) {
  <span style="color:#080;font-weight:bold">if</span> (item == <span style="color:#069">null</span>) { <span style="color:#777">// no context</span>
    <span style="color:#080;font-weight:bold">return</span> FormValidation.ok();
  }
  item.checkPermission(Item.CONFIGURE);

  <span style="color:#080;font-weight:bold">if</span> (<span style="color:#0a8;font-weight:bold">Util</span>.fixEmptyAndTrim(value) == <span style="color:#069">null</span>) {
    <span style="color:#080;font-weight:bold">return</span> FormValidation.error(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo cannot be empty</span><span style="color:#710">&quot;</span></span>);
  }
  <span style="color:#080;font-weight:bold">return</span> FormValidation.ok();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="protecting-from-csrf"><a class="anchor" href="#protecting-from-csrf"></a>Protecting from CSRF</h4>
<div class="paragraph">
<p>Stapler web methods, like form validation, can be invoked using any HTTP verb by default.
This can be used by malicious users to attack an application by way of its legitimate users:
Cross-site request forgery is the result of a web application (Jenkins) trusting legitimate users' browser.</p>
</div>
<div class="paragraph">
<p>To prevent this, Jenkins includes CSRF protection that requires actions with side effects (POST requests) to submit a user-specific secret, called a <em>crumb</em>.
To ensure this protection is relevant, web methods with side effects need to reject requests not sent via POST.
There are two options to achieve this in general:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://stapler.kohsuke.org/apidocs/org/kohsuke/stapler/verb/POST.html" title="Javadoc for org.kohsuke.stapler.verb.POST"><code>POST</code></a> limits processing to just the POST verb, and all other verbs will receive a 404 response. This is recommended approach for form validation methods.</p>
</li>
<li>
<p><a href="http://stapler.kohsuke.org/apidocs/org/kohsuke/stapler/interceptor/RequirePOST.html" title="Javadoc for org.kohsuke.stapler.interceptor.RequirePOST"><code>RequirePOST</code></a> is the older (and more common) approach. It will show a form allowing users to resubmit the request using POST if they used a different verb. This is mostly useful for simple API actions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Applying this protection is as simple as adding the annotation to the method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span style="color:#007">@POST</span>
<span style="color:#088;font-weight:bold">public</span> FormValidation doCheckFoo(<span style="color:#007">@QueryParameter</span> <span style="color:#0a8;font-weight:bold">String</span> value) {
  <span style="color:#080;font-weight:bold">if</span> (<span style="color:#0a8;font-weight:bold">Util</span>.fixEmptyAndTrim(value) == <span style="color:#069">null</span>) {
    <span style="color:#080;font-weight:bold">return</span> FormValidation.error(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo cannot be empty</span><span style="color:#710">&quot;</span></span>);
  }
  <span style="color:#080;font-weight:bold">return</span> FormValidation.ok();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Most form validation methods are invoked using HTTP GET, however, so the form needs to be adapted as well.
A notable exception to this is <code>f:validateButton</code>, which is always submitted using HTTP POST.</p>
</div>
<div class="paragraph">
<p>The Jenkins form Jelly controls support the <code>checkMethod</code> attribute, which, if set to <code>post</code>, will result in form validation being invoked via HTTP POST.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;f:entry</span> <span style="color:#b48">field</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;f:textbox</span> <span style="color:#b48">checkMethod</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">post</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/f:entry&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some form controls don&#8217;t declare the <code>checkMethod</code> attribute. It should still work, but it might be highlighted as an error in your IDE.
</td>
</tr>
</table>
</div>
</div>
</div>

</div>
</div>
</div>


<script src="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/assets/bower/anchor-js/anchor.min.js"></script>
<script src="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/assets/bower/tether/js/tether.min.js"></script>
<script src="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<footer id="footer">
<div class="container">
<div class="row">
<div class="col-md-4">
<p class="box">
<a href="https://github.com/jenkins-infra/jenkins.io/edit/master/content//doc/developer/security/form-validation.adoc" title="Edit /doc/developer/security/form-validation.adoc on GitHub">Improve this page</a>
|
<a href="https://github.com/jenkins-infra/jenkins.io/commits/master/content//doc/developer/security/form-validation.adoc" title="View /doc/developer/security/form-validation.adoc history on GitHub">Page history</a>
</p>
<div class="license-box">
<div id="creativecommons">
<a href="https://creativecommons.org/licenses/by-sa/4.0/">
<p>
<img alt="Creative Commons Attribution-ShareAlike license" src="https://licensebuttons.net/l/by-sa/4.0/88x31.png">
</p>
</a>
<p>
The content driving this site is licensed under the Creative
Commons Attribution-ShareAlike 4.0 license.
</p>
</div>
</div>
</div>
<div class="links col-md-8">
<div class="container">
<div class="row">
<div class="area col-md-3">
<div class="div-mar">
<h5>Resources</h5>
<ul class="resources">
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/events">
Events
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/doc">
Documentation
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/node">
Blog
</a>
</li>
</ul>
</div>
</div>
<div class="area col-md-3">
<div class="div-mar">
<h5>Solutions</h5>
<ul>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/android">
Android
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/c">
C/C++
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/docker">
Docker
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/embedded">
Embedded
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/github">
GitHub
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/java">
Java
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/php">
PHP
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/pipeline">
Continuous Delivery
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/python">
Python
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/solutions/ruby">
Ruby
</a>
</li>
</ul>
</div>
</div>
<div class="area col-md-3">
<div class="div-mar">
<h5>Project</h5>
<ul class="project">
<li>
<a href="https://issues.jenkins-ci.org">
Issue tracker
</a>
</li>
<li>
<a href="https://wiki.jenkins.io">
Wiki
</a>
</li>
<li>
<a href="https://github.com/jenkinsci">
GitHub
</a>
</li>
<li>
<a href="https://ci.jenkins.io">
Jenkins on Jenkins
</a>
</li>
</ul>
</div>
</div>
<div class="area col-md-3">
<div class="div-mar">
<h5>Community</h5>
<ul class="community">
<li>
<a href="https://groups.google.com/forum/#!forum/jenkinsci-users">
Users mailing list
</a>
</li>
<li>
<a href="https://groups.google.com/forum/#!forum/jenkinsci-dev">
Developers mailing list
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/sigs">
Special Interest Groups
</a>
</li>
<li>
<a href="https://twitter.com/jenkinsci">
Twitter
</a>
</li>
<li>
<a href="https://reddit.com/r/jenkinsci">
Reddit
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/merchandise">
Merchandise
</a>
</li>
<li>
<a href="https://tempora-mutantur.github.io/jenkins.io/github_pages_test/awards">
Awards
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  !function(d,s,id) {
    var js, fjs=d.getElementsByTagName(s)[0];
    if (!d.getElementById(id)) {
      js = d.createElement(s);
      js.id=id;
      js.src="//platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js,fjs);
    }
  }(document,"script","twitter-wjs");
  
  $(function(){
    var $body = $(document.body);
    $(".nav-link.dropdown-toggle").on("mousedown", function(){
      $body.addClass("no-outline");
    })
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
</body>
</html>
